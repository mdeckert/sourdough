================================================================================
BUGFIX - QR Code "Method Not Allowed" Error
================================================================================

Date: 2025-10-07

ISSUE
================================================================================

When scanning the START LOAF QR code (or any event QR code), users received:
  "Method not allowed"

CAUSE
================================================================================

QR codes use GET requests when scanned by phone camera, but the server
endpoints were configured to only accept POST requests.

When you scan a QR code:
  Phone ‚Üí Opens URL in browser ‚Üí GET request
  But server expected ‚Üí POST request
  Result ‚Üí Error

FIX APPLIED
================================================================================

1. Updated /bake/start endpoint to accept both GET and POST
2. Updated /log/* endpoints to accept both GET and POST
3. Added beautiful confirmation pages for GET requests
4. POST requests still return JSON (for CLI and automation)

Now when you scan a QR code:
  Phone ‚Üí GET request ‚Üí Success page with ‚úÖ
  CLI ‚Üí POST request ‚Üí JSON response

CONFIRMATION PAGES
================================================================================

When scanning QR codes, you now see nice mobile-friendly pages:

START LOAF (success):
  ‚úÖ
  Bake Started!
  Your loaf has been logged

START LOAF (already started):
  ‚ö†Ô∏è
  Already Started
  You already started a bake today!

All other events:
  ‚úÖ
  [event-name]
  Event logged successfully
  [timestamp]

TESTING COMPLETED
================================================================================

‚úì START LOAF QR code works
‚úì All event QR codes work (fold, mixed, shaped, etc.)
‚úì Confirmation pages display correctly on mobile
‚úì CLI commands still work with POST
‚úì Data logged correctly to .jsonl files

HOW TO TEST
================================================================================

1. Scan START LOAF QR code
   ‚Üí Should see green success page with ‚úÖ

2. Scan any event QR code (fold, mixed, etc.)
   ‚Üí Should see green confirmation page

3. Check status:
   sourdough status

4. Verify data:
   cat data/bake_2025-10-07.jsonl

TECHNICAL DETAILS
================================================================================

Changed in: internal/server/handlers.go

Before:
  if r.Method != http.MethodPost {
      http.Error(w, "Method not allowed", ...)
  }

After:
  if r.Method != http.MethodPost && r.Method != http.MethodGet {
      http.Error(w, "Method not allowed", ...)
  }

  // Show nice HTML for GET (QR scans)
  if r.Method == http.MethodGet {
      w.Header().Set("Content-Type", "text/html")
      w.Write([]byte(successHTML))
      return
  }

  // Return JSON for POST (CLI)
  w.Header().Set("Content-Type", "application/json")
  json.NewEncoder(w).Encode(...)

STATUS
================================================================================

‚úÖ FIXED - All QR codes now work correctly
‚úÖ Server rebuilt and restarted
‚úÖ Testing completed
‚úÖ Ready to use

You can now scan any QR code and it will work! üçû
================================================================================
